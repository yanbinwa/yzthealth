<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<link rel="stylesheet" type="text/css" href="{$CSS}wm/bootstrap_min.css" media="all" />
<link rel="stylesheet" type="text/css" href="{$CSS}wm/bootstrap_responsive_min.css" media="all" />
<link rel="stylesheet" type="text/css" href="{$CSS}wm/style.css" media="all" />
<link rel="stylesheet" type="text/css" href="{$CSS}wm/todc_bootstrap.css" media="all" />
<link rel="stylesheet" type="text/css" href="{$CSS}wm/chosen.css" media="all" />

<link rel="stylesheet" type="text/css" href="{$CSS}wm/themes.css" media="all" />
<link rel="stylesheet" type="text/css" href="{$CSS}wm/inside.css" media="all" />
<link rel="stylesheet" type="text/css" href="{$CSS}wm/resource.css" media="all" />
<title>{$_SERVER['WEB_NAME']}</title>
<script type="text/javascript" src="{$JS}bootstrap_min.js"></script>
<script type="text/javascript" src="{$JS}jquery_form_min.js"></script>
<script type="text/javascript" src="{$JS}jquery_validate_min.js"></script>
<script type="text/javascript" src="{$JS}jquery_validate_methods.js"></script>
<script type="text/javascript" src="{$JS}chosen_jquery_min.js"></script>
<script type="text/javascript" src="{$JS}inside.js"></script>
<script>
    $(function(){
        $('#chkIsRead').click(function(){
            $("#bsubmit").toggle();
        });
    });
</script>
<style type="text/css" media="screen">
 
.LR_register_xieyi {
    border: 1px solid #e6e6e6;
    float: left;
    margin: 20px 20px;
    width: 520px;
}
.zhuce_xy {
    border: 1px solid #e6e6e6;
    float: left;
    height: 150px;
    overflow: auto;
    width: 650px;
}

</style>
</head>
<body class="{Session::get('maintheme')}">
	
    <div id="main">
        <div class="container-fluid">

            <div class="row-fluid">
                <div class="span12">
                    <div class="box">
                        <div class="box-title">
                            <div class="span10">
                                <h3><i class="icon-edit"></i>添加商户账号</h3>
                            </div>
                            <div class="span2"><a class="btn" href="Javascript:window.history.go(-1)">返回</a></div>
                        </div>

                        <div class="box-content">
                            <form action="" method="post" id="transform" class="form-horizontal form-validate" onsubmit="return check()" >
                             
                     
								
							   <div class="control-group">
                                    <label for="name" class="control-label">用户名：</label>
                                    <div class="controls">
                                        {$m->text('uns','class="input-large" required="required" ')}
                                        <span class="maroon">*</span>
                                        <span class="help-inline"></span>
                                    </div>
                                </div>
                                <div class="control-group">
                                    <label for="sort" class="control-label">密码：</label>
                                    <div class="controls">
                                        {$m->password('passwords','class="input-large" required="required" ')}
                                        <span class="maroon">*</span>
                                    </div>
                                </div>
                               
									
									 <div class="control-group">
                                        <label class="control-label" for="fanslocal">商铺名称</label>
                                        <div class="controls">
                                            {$m->text('shopname','class="input-large"  required="required" data-rule-phone="true" ')}
                                            <span class="maroon">*</span>
                                            <span class="help-inline"></span>
                                        </div>
                                    </div>
									
									<div class="control-group">
									   <label class="control-label">门面照片</label>
										<div class="controls">
											<img class="thumb_img" src="{$m->dz}" id="pic_dz" relobj="elfinder_dz" style="max-height:100px;" />
											{$m->hidden('dz',' relobj="elfinder_dz"')}
											<span class="help-inline">
												<button class="btn select_img" type="button" rel="yyuc" relobj="elfinder" id="dz" >选择门面照</button>
												<span class="help-inline">建议尺寸：宽320像素，高220像素</span>
											</span>
										</div>
								    </div>
									
									<div class="control-group">
									   <label class="control-label">营业执照(正面)</label>
										<div class="controls">
											<img class="thumb_img" src="{$m->yyzz}" id="pic_yyzz" relobj="elfinder_yyzz" style="max-height:100px;" />
											{$m->hidden('yyzz',' relobj="elfinder_yyzz"')}
											<span class="help-inline">
												<button class="btn select_img" type="button" rel="yyuc" relobj="elfinder" id="yyzz" >选择营业执照</button>
												<span class="help-inline"></span>
											</span>
										</div>
								    </div>
									
									<div class="control-group">
                                        <label class="control-label" for="location_p">商家所在地区</label>
                                        <div class="controls">
										    {$m->mulselect('chinaarea',array('location_p','location_c','location_a'))}
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label class="control-label" for="fanslocal">商家详细地址</label>
                                        <div class="controls">
                                            {$m->hidden('jd')}
                                            {$m->hidden('wd')}
                                            {$m->text('address','class="input-xlarge"  data-rule-maxlength="50" ')}
                                            <span class="maroon"></span>
                                            <span class="help-inline"></span>
                                        </div>
                                    </div>
                                    <div class="control-group">
                                        <label for="dtapi" class="control-label">选择地址</label>
                                        <div class="controls">
                                            <div class="apicontent" id="apicontent" style="height:400px; width:600px;">
                                                
                                            </div>
                                        </div>
                                    </div>
									
									<div class="control-group">
                                        <label class="control-label" for="fanslocal">经营模式</label>
                                        <div class="controls">
										    {$m->select($jyms,'jyms','class="input-xlarge"')}
                                            <span class="maroon"></span>
                                            <span class="help-inline"></span>
                                        </div>
                                    </div>
									
									<div class="control-group">
                                        <label class="control-label" for="fanslocal">企业类型</label>
                                        <div class="controls">
										    {$m->select($qylx,'qylx','class="input-xlarge"')}
                                            <span class="maroon"></span>
                                            <span class="help-inline"></span>
                                        </div>
                                    </div>
									
									 <div class="control-group">
                                        <label class="control-label" for="fanslocal">联系人</label>
                                        <div class="controls">
                                            {$m->text('lxr','class="input-large"    ')}
                                            <span class="maroon">*</span>
                                            <span class="help-inline"></span>
                                        </div>
									 </div>
									 
									 <div class="control-group">
										<label class="control-label" for="fanslocal">商铺电话</label>
										<div class="controls">
											{$m->text('lxrtel','class="input-large"  data-rule-phone="true" ')}
											<span class="maroon">*</span>
											<span class="help-inline"></span>
										</div>
									 </div>
									 
									 <div class="control-group">
										<label class="control-label" for="fanslocal">企业QQ</label>
										<div class="controls">
											{$m->text('qq','class="input-large"   data-rule-phone="true" ')}
											<span class="maroon">*</span>
											<span class="help-inline"></span>
										</div>
									 </div>
									 
									  <div class="control-group">
										<label class="control-label" for="fanslocal">邮箱</label>
										<div class="controls">
											{$m->email('email','class="input-large" data-rule-phone="true" ')}
											<span class="maroon">*</span>
											<span class="help-inline"></span>
										</div>
									 </div>
									 
									 
									 
								 
                                    <script src="{$JS}category.js"></script>
                                    <script type="text/javascript">
                                        new CS("lgc_supplier_usercategory_f", "lgc_supplier_usercategory_s", "{$m->category_f}",  "{$m->category_s}", '美食-1$本帮江浙菜-11,川菜-12,粤菜-13,湘菜-14,贵州菜-15,东北菜-16,台湾菜-17,新疆/清真菜-18,西北菜-19,素菜-20,火锅-21,自助餐-22,小吃快餐-23,日本-24,韩国料理-25,东南亚菜-26,西餐-27,面包甜点-28,其他-29#休闲娱乐-2$密室-30,咖啡厅-31,酒吧-32,茶馆-33,KTV-34,电影院-35,文化艺术-36,景点/郊游-37,公园-38,足疗按摩-39,洗浴-40,游乐游艺-41,桌球-42,桌面游戏-43,DIY手工坊-44,其他-45#购物-3$综合商场-46,食品茶酒-47,服饰鞋包-48,珠宝饰品-49,化妆品-50,运动户外-51,亲子购物-52,品牌折扣店-53,数码家电-54,家居建材-55,特色集市-56,书店-57,花店-58,眼镜店-59,超市/便利店-60,药店-61,其他-62#丽人-4$美发-63,美容/SPA-64,化妆品-65,瘦身纤体-66,美甲-67,瑜伽-68,舞蹈-69,个性写真-70,整形-71,齿科-72,其他-73#结婚-5$婚纱摄影-74,婚宴-75,婚戒首饰-76,婚纱礼服-77,婚庆公司-78,彩妆造型-79,司仪主持-80,婚礼跟拍-81,婚车租赁-82,婚礼小商品-83,婚房装修-84,其他-85#亲子-6$幼儿教育-86,亲子摄影-87,亲子游乐-88,亲子购物-89,孕产护理-90,其他-91#运动健身-7$游泳馆-92,羽毛球馆-93,健身中心-94,瑜伽-95,舞蹈-96,篮球场-97,网球场-98,足球场-99,高尔夫场-100,保龄球馆-101,桌球馆-102,乒乓球馆-103,武术场馆-104,体育场馆-105,其他-106#酒店-8$五星级酒店-107,四星级酒店-108,三星级酒店-109,经济型酒店-110,公寓式酒店-111,精品酒店-112,青年旅舍-113,度假村-114,其他-115#爱车-9$4S店/汽车销售-116,汽车保险-117,维修保养-118,配件/车饰-119,驾校-120,汽车租赁-121,停车场-122,加油站-123,其他-124#生活服务-10$旅行社-125,培训-126,室内装潢-127,宠物-128,齿科-129,快照/冲印-130,家政-131,银行-132,学校-133,团购网站-134,其他-135#其他-11$其他-136');
                                    </script>
                                    <!-- <div class="control-group">
                                        <label class="control-label" for="category_f">商家主营</label>
                                        <div class="controls">
                                            {$m->select($majorInfo,'major')}
                                        </div>
                                    </div>
                                                                        
                                                                        <div class="control-group">
                                        <label class="control-label" for="fanslocal">主营品牌</label>
                                        <div class="controls">
                                            {$m->text('pp','class="input-xlarge"  data-rule-maxlength="150" ')}
                                            <span class="maroon"></span>
                                            <span class="help-inline"></span>
                                        </div>
                                    </div> -->
									
									 <div class="control-group">
										<label class="control-label" for="title">商家简介：</label>
										<div class="controls">
										 {$m->texteditor('jianjie',3, '650px','450px' )}
										</div>
									</div>

                                    <!-- <div class="control-group">
                                        <label class="control-label" for="category_f">注册协议</label>
                                        <div class="zhuce_xy LR_register_xieyi">
                                           {$banquanm->zcxy}
                                        </div>
                                        
                                    </div> -->
                                    
									
									
									<hr>
									
									<!-- <div class="control-group">
                                        <label class="control-label" for="category_f">商家等级</label>
                                        <div class="controls">
                                            {$m->select($dengji,'dj')}
                                        </div>
                                    </div>
									
                                    <div class="control-group">
                                        <label class="control-label" for="title">商户推荐类型：</label>
                                        <div class="controls">
                                           <label class="attr">
                                            {$m->checkbox('hot')}
                                            热门商户
                                            {$m->checkbox('zx')}
                                            最新商户
                                            </label>
                                        </div>
                                    </div>

                                <div class="control-group">
                                    <label for="sort" class="control-label">状态：</label>
                                    <div class="controls">
                                        {$m->select($status,'status','',false)}
                                        <span class="maroon">*</span>
                                    </div>
                                </div> -->

                                <div class="form-actions">
                                    <!-- <label class="control-label" for="category_f">
                                    <input name="chkIsRead" id="chkIsRead" type="checkbox" value="我已阅读" checked="true" />
                                    &nbsp;我已阅读注册协议
                                    </label> -->
                                    
                                    <button id="bsubmit" type="submit" data-loading-text="提交中..." class="btn btn-primary">保存</button>
                                    <button type="button" class="btn" onclick="Javascript:window.history.go(-1)">取消</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="http://api.map.baidu.com/api?key=dcfa9f8a2940f495d0441096189499ec&v=1.4&services=true"></script>

<script type="text/javascript">
function check()
{
	var cansv= true;
	$("#transform").find('input[type="text"],select,textarea,password').filter('[required="required"]').each(function(){
		if($.trim($(this).val())==''){
			cansv = false;
			$(this).css('backgroundColor','yellow');
			$(this).one('focus',function(){
				$(this).css('backgroundColor','transparent');
			});
		}
	});
	if(!cansv){
		G.ui.tips.info('请将信息填写完整'); 
		return cansv;
	}
}
////////
// 百度地图API功能
    
    var map = new BMap.Map("apicontent");  // 创建Map实例
    var point = new BMap.Point();
    map.centerAndZoom(point, 15);
    var opts = { anchor: BMAP_ANCHOR_BOTTOM_LEFT, offset: new BMap.Size(10, 10)}   //本示例将标准地图控件放置在地图的右上角，间隔10个像素。 
    map.addControl(new BMap.NavigationControl(opts));   //添加平移缩放控件
    map.addControl(new BMap.ScaleControl());    //添加比例尺控件
    map.addControl(new BMap.OverviewMapControl());   //添加缩略地图控件
    map.enableScrollWheelZoom();   //启用滚轮放大缩小，默认禁用
    map.enableContinuousZoom();    //启用地图惯性拖拽，默认禁用 
    // 编写自定义函数,创建标注
    function addMarker(point){ 
      var marker = new BMap.Marker(point);
      map.addOverlay(marker);
    }
    function myFun(result){
        var cityName = result.name;
        map.setCenter(cityName);
    }
    var lng = $('#lgc_supplier_userjd').val();
    var lat = $('#lgc_supplier_userwd').val();
    var markera = new BMap.Marker(new BMap.Point(lng,lat));
    map.addOverlay(markera);
    var cc = $('#lgc_supplier_userlocation_p').find("option:selected").text();
    //选择城市 更改中心点 
    $('#lgc_supplier_userlocation_p').change(function(){
        cc = $(this).find("option:selected").text(); 
        map.clearOverlays();  
         map.setCenter(cc);
    })
    $('#lgc_supplier_userlocation_c').change(function(){
        cc = $(this).find("option:selected").text(); 
        map.clearOverlays();  
         map.setCenter(cc);
    })
    $('#lgc_supplier_userlocation_a').change(function(){
        cc = $(this).find("option:selected").text(); 
        map.clearOverlays();  
         map.setCenter(cc);
    })
    $('#lgc_supplier_useraddress').blur(function(){
        //获取 详细地点
        var dz =$('#lgc_supplier_useraddress').val();
        // 地点解析 经纬度
        if(dz !=null || dz !=''){
            var myGeo = new BMap.Geocoder();
            // 将地址解析结果显示在地图上,并调整地图视野
            myGeo.getPoint(dz, function(point){
                if (point) {
                    console.log(point);
                    $('#lgc_supplier_userjd').val(point.lng);
                    $('#lgc_supplier_userwd').val(point.lat);
                    map.clearOverlays();  
                    map.centerAndZoom(point, 15);
                    map.addOverlay(new BMap.Marker(point));
                }else{
                    alert("您选择地址没有解析到结果!");
                }
            },cc); 
        }
    })
        

    var myCity = new BMap.LocalCity();
    myCity.get(myFun);

    //点击更新点
    function showInfo(e){
        $('#lgc_supplier_userjd').val(e.point.lng);
        $('#lgc_supplier_userwd').val(e.point.lat);
        map.clearOverlays();
        map.addOverlay(new BMap.Marker(e.point));
    }
    map.addEventListener("click", showInfo);
</script>
</html>
